# -*- coding: utf-8 -*-
# For Notepad++ PythonScript 2.1.0.0, Python 2.7

from Npp import notepad, editor

# Insert template
template_lines = [
    "SR#",
    "",
    "Policy:",
    "Policy Status:",
    "Line of Business:",
    "Session:",
    ""
]

editor.setText('\n'.join(template_lines))

# Move cursor to Policy Status line
policy_status_line = 3  # 0-based index
editor.gotoLine(policy_status_line)

# Dropdown 1: Policy Status
policy_status_options = ["Active", "Inactive"]
policy_status_menu = "\n".join(
    ["%d. %s" % (i + 1, opt) for i, opt in enumerate(policy_status_options)]
)
while True:
    policy_status_choice = notepad.prompt(
        "Select Policy Status:\n" + policy_status_menu, "Policy Status"
    )
    if policy_status_choice and policy_status_choice.strip().isdigit():
        idx = int(policy_status_choice.strip()) - 1
        if 0 <= idx < len(policy_status_options):
            policy_status_value = policy_status_options[idx]
            break
    notepad.messageBox("Invalid selection. Please enter 1 or 2.", "Error")

# Replace Policy Status line
editor.replaceWholeLine(policy_status_line, "Policy Status: %s\n" % policy_status_value)

# Move cursor to Line of Business
lob_line = 4  # 0-based index
editor.gotoLine(lob_line)

# Dropdown 2: Line of Business
lob_options = [
    "Artisan Contractor", "Auto Service & Repair", "Commercial Auto",
    "Habitational", "Manufacturing", "Real Estate", "Restaurant",
    "Retail", "Umbrella", "Wholesale"
]
lob_menu = "\n".join(
    ["%d. %s" % (i + 1, opt) for i, opt in enumerate(lob_options)]
)
while True:
    lob_choice = notepad.prompt(
        "Select Line of Business:\n" + lob_menu, "Line of Business"
    )
    if lob_choice and lob_choice.strip().isdigit():
        idx = int(lob_choice.strip()) - 1
        if 0 <= idx < len(lob_options):
            lob_value = lob_options[idx]
            break
    notepad.messageBox("Invalid selection. Please enter a number from 1 to 10.", "Error")

# Replace Line of Business line
editor.replaceWholeLine(lob_line, "Line of Business: %s\n" % lob_value)

# Move cursor to Session (optional: for your workflow)
session_line = 5
editor.gotoLine(session_line)

notepad.messageBox("Form created and filled!", "Done")
